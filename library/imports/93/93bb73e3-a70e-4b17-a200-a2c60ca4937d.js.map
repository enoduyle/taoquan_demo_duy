{"version":3,"sources":["../../../../../../assets/cc-common/cc-share-v1/common/assets/cc-common/cc-share-v1/common/CacheChildrenRender.js"],"names":["cc","Class","extends","Component","properties","pageIndex","isCustomView","customWidth","customHeight","onLoad","positionCache","node","position","opacity","x","camera","addComponent","Camera","cullingMask","_cullingMask","children","forEach","child","group","start","scheduleOnce","renderTexture","RenderTexture","initWithSize","winSize","width","height","targetTexture","render","spriteFrame","SpriteFrame","sprieComp","getComponent","Sprite","removeAllChildren","scaleY","removeComponent","Number"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,mBAAW,CADH;AAERC,sBAAc,KAFN;AAGRC,qBAAa,GAHL;AAIRC,sBAAc;AAJN,KAFP;;AASLC,UATK,oBASI;AAAA;;AACL,aAAKC,aAAL,GAAqB,KAAKC,IAAL,CAAUC,QAA/B;AACA,aAAKD,IAAL,CAAUE,OAAV,GAAoB,CAApB;AACA,aAAKF,IAAL,CAAUG,CAAV,GAAc,IAAd;AACA,aAAKC,MAAL,GAAc,KAAKJ,IAAL,CAAUK,YAAV,CAAuBhB,GAAGiB,MAA1B,CAAd;AACA,aAAKF,MAAL,CAAYG,WAAZ,GAA0B,KAAKP,IAAL,CAAUQ,YAApC;AACA,aAAKR,IAAL,CAAUS,QAAV,CAAmBC,OAAnB,CAA2B,iBAAS;AAChCC,kBAAMC,KAAN,GAAc,MAAKZ,IAAL,CAAUY,KAAxB;AACH,SAFD;AAGH,KAlBI;AAoBLC,SApBK,mBAoBG;AAAA;;AACJ,aAAKC,YAAL,CAAkB,YAAM;AACpB,mBAAKd,IAAL,CAAUE,OAAV,GAAoB,GAApB;AACA,gBAAMa,gBAAgB,IAAI1B,GAAG2B,aAAP,EAAtB;AACA,gBAAI,CAAC,OAAKrB,YAAV,EAAwB;AACpBoB,8BAAcE,YAAd,CAA2B5B,GAAG6B,OAAH,CAAWC,KAAtC,EAA6C9B,GAAG6B,OAAH,CAAWE,MAAxD;AACH,aAFD,MAEO;AACHL,8BAAcE,YAAd,CAA2B,OAAKrB,WAAhC,EAA6C,OAAKC,YAAlD;AACH;AACD,mBAAKO,MAAL,CAAYiB,aAAZ,GAA4BN,aAA5B;AACA,mBAAKX,MAAL,CAAYkB,MAAZ,CAAmB,OAAKtB,IAAxB;AACA,gBAAIuB,cAAc,IAAIlC,GAAGmC,WAAP,CAAmBT,aAAnB,CAAlB;;AAEA,gBAAIU,YAAY,OAAKzB,IAAL,CAAU0B,YAAV,CAAuBrC,GAAGsC,MAA1B,CAAhB;AACA,gBAAI,CAACF,SAAL,EAAgBA,YAAY,OAAKzB,IAAL,CAAUK,YAAV,CAAuBhB,GAAGsC,MAA1B,CAAZ;AAChBF,sBAAUF,WAAV,GAAwBA,WAAxB;;AAEA,mBAAKvB,IAAL,CAAU4B,iBAAV;AACA,mBAAK5B,IAAL,CAAU6B,MAAV,GAAmB,CAAC,CAApB;AACA,mBAAK7B,IAAL,CAAU8B,eAAV,CAA0BzC,GAAGiB,MAA7B;AACA,mBAAKN,IAAL,CAAUC,QAAV,GAAqB,OAAKF,aAA1B;AACH,SApBD,EAoBGgC,OAAO,SAAS,KAAKrC,SAAL,GAAiB,CAAjB,GAAqB,KAAKA,SAA1B,GAAsC,CAA/C,CAAP,CApBH;AAqBH;AA1CI,CAAT","file":"CacheChildrenRender.js","sourceRoot":"../../../../../../assets/cc-common/cc-share-v1/common","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        pageIndex: 1,\n        isCustomView: false,\n        customWidth: 720,\n        customHeight: 1280,\n    },\n\n    onLoad() {\n        this.positionCache = this.node.position;\n        this.node.opacity = 0;\n        this.node.x = 3000;\n        this.camera = this.node.addComponent(cc.Camera);\n        this.camera.cullingMask = this.node._cullingMask;\n        this.node.children.forEach(child => {\n            child.group = this.node.group;\n        });\n    },\n\n    start() {\n        this.scheduleOnce(() => {\n            this.node.opacity = 255;\n            const renderTexture = new cc.RenderTexture();\n            if (!this.isCustomView) {\n                renderTexture.initWithSize(cc.winSize.width, cc.winSize.height);\n            } else {\n                renderTexture.initWithSize(this.customWidth, this.customHeight);\n            }\n            this.camera.targetTexture = renderTexture;\n            this.camera.render(this.node);\n            let spriteFrame = new cc.SpriteFrame(renderTexture);\n\n            let sprieComp = this.node.getComponent(cc.Sprite);\n            if (!sprieComp) sprieComp = this.node.addComponent(cc.Sprite);\n            sprieComp.spriteFrame = spriteFrame;\n\n            this.node.removeAllChildren();\n            this.node.scaleY = -1;\n            this.node.removeComponent(cc.Camera);\n            this.node.position = this.positionCache;\n        }, Number(0.017 * (this.pageIndex > 0 ? this.pageIndex : 1)));\n    },\n\n});"]}