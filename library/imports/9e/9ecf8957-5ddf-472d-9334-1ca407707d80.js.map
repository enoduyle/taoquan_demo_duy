{"version":3,"sources":["../../../../../../assets/cc-common/cc-slotbase-v2/component/assets/cc-common/cc-slotbase-v2/component/RenderedTextureFactory.js"],"names":["SymbolContext","cc","Class","name","properties","symbolNode","Node","spine","sp","Skeleton","symbolIndex","symbolCode","NormalSymbolContainer","container","row","col","padding","symbolList","type","default","MegaSymbolData","skeletonFile","SkeletonData","MegaSymbolContainer","currentSymbolCode","megaSymbols","SymbolDataType","Enum","NORMAL","MEGA","SymbolSpriteData","spriteFrame","SpriteFrame","width","height","symbolType","index","isRendering","extends","Component","turnOnAtStart","fps","rootContainer","renderCamera","Camera","renderTexture","RenderTexture","visible","normalSymbolContainer","megaSymbolContainer","IsEnable","get","_isEnable","set","value","IsPlayingMegaSymbol","_isPlayingMegaSymbol","onLoad","_spriteDatabase","_standartFps","_tick","log","start","spriteCount","length","i","symbolSpriteData","push","megaSymbolSpriteData","snapShot","turnOffRenderTextureSystem","turnOnRenderTextureSystem","node","active","stopAllNormalSymbolAnimation","stopMegaSymbolAnimation","setDefaultPerformance","setLowPerformance","getRTSpriteFrame","skinName","isMega","_symbolCode","setUpMegaSymbol","playNormalSymbolAnimation","playMegaSymbolAnimation","skeletonData","isloop","paused","angle","opacity","setSkin","setAnimation","children","childNode","stopNormalSymbolAnimation","playAllNormalSymbolAnimation","isLoop","initWithSize","targetTexture","render","normalPadding","normalIndex","colIndex","rowIndex","Math","floor","preWidth","preHeight","x","y","setTexture","Rect","update","onDestroy","destroy"],"mappings":"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","file":"RenderedTextureFactory.js","sourceRoot":"../../../../../../assets/cc-common/cc-slotbase-v2/component","sourcesContent":["\n\nconst SymbolContext = cc.Class({\n    name: 'SymbolContext',\n    properties:{\n        symbolNode: cc.Node,\n        spine: sp.Skeleton,\n        symbolIndex: 0,\n        symbolCode: \"\",\n    },\n    \n});\n\nconst NormalSymbolContainer = cc.Class({\n    name: 'NormalSymbolContainer',\n    properties: {\n        container: cc.Node,\n        row:2,\n        col: 4,\n        padding: 10,\n        symbolList: {\n            type: SymbolContext,\n            default: [],\n        }\n    },\n});\n\nconst MegaSymbolData = cc.Class({\n    name: 'MegaSymbolData',\n    properties:{\n        skeletonFile: sp.SkeletonData,\n        symbolCode: \"\",\n    },\n});\n\nconst MegaSymbolContainer = cc.Class({\n    name: 'MegaSymbolContainer',\n    properties:{\n        symbolNode: cc.Node,\n        spine: sp.Skeleton,\n        currentSymbolCode: '',\n        megaSymbols:{\n            type: MegaSymbolData,\n            default: [],\n        },\n    },\n});\nconst SymbolDataType = cc.Enum({\n    NORMAL: 0,\n    MEGA: 1,\n});\nconst SymbolSpriteData = cc.Class({\n    name : 'SymbolSpriteData',\n    properties:{\n        spriteFrame: cc.SpriteFrame,\n        width: 100,\n        height: 100,\n        symbolType: {\n            type: SymbolDataType,\n            default: SymbolDataType.NORMAL,\n        },\n        symbolCode: '',\n        index: 0,\n        isRendering: true,\n    }\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        turnOnAtStart: false,\n        fps: 30,\n        rootContainer: cc.Node,\n        renderCamera: cc.Camera,\n        padding: 10,\n        renderTexture: {\n            type: cc.RenderTexture,\n            default: null,\n            visible: false,\n        },\n\n        normalSymbolContainer:{\n            type: NormalSymbolContainer,\n            default: null,\n        },\n\n        megaSymbolContainer: {\n            type: MegaSymbolContainer,\n            default: null,\n        },\n\n        IsEnable:{\n            get (){\n                return this._isEnable;\n            },\n\n            set(value){\n                this._isEnable = value;\n            },\n\n            visible: false,\n        },\n\n        IsPlayingMegaSymbol:{\n            get (){\n                return this._isPlayingMegaSymbol;\n            },\n            visible: false,\n        },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this._spriteDatabase = [];\n        this._isEnable = false; \n        this._standartFps = 60;\n        this._tick = 0;\n        this._isPlayingMegaSymbol = false;\n        cc.log(\"Load Rendered Texture System\");\n    },\n\n    start () {\n        this.renderTexture = new cc.RenderTexture();\n        \n        const spriteCount = this.normalSymbolContainer.symbolList.length + 1;\n        cc.log(`Total Sprite Frame in Render Texture: ${spriteCount}`);\n        for(let i = 0; i < this.normalSymbolContainer.symbolList.length; i++){\n            let symbolSpriteData = new SymbolSpriteData();\n            symbolSpriteData.spriteFrame = new cc.SpriteFrame();\n            symbolSpriteData.symbolCode = this.normalSymbolContainer.symbolList[i].symbolCode;\n            symbolSpriteData.width = this.normalSymbolContainer.symbolList[i].symbolNode.width;\n            symbolSpriteData.height = this.normalSymbolContainer.symbolList[i].symbolNode.height;\n            symbolSpriteData.symbolType = SymbolDataType.NORMAL;\n            symbolSpriteData.index = this.normalSymbolContainer.symbolList[i].symbolIndex;\n            symbolSpriteData.isRendering = true;\n            this._spriteDatabase.push(symbolSpriteData);\n        }\n        let megaSymbolSpriteData = new SymbolSpriteData();\n        megaSymbolSpriteData.spriteFrame = new cc.SpriteFrame();\n        megaSymbolSpriteData.symbolCode = 'M';\n        megaSymbolSpriteData.width = this.megaSymbolContainer.symbolNode.width*4/5;\n        megaSymbolSpriteData.height = this.megaSymbolContainer.symbolNode.height;\n        megaSymbolSpriteData.symbolType = SymbolDataType.MEGA;\n        megaSymbolSpriteData.isRendering = true;\n        this._spriteDatabase.push(megaSymbolSpriteData);\n        this.snapShot();\n        this.turnOffRenderTextureSystem();\n        if(this.turnOnAtStart){\n            this.turnOnRenderTextureSystem();\n        }\n        // this.snapShot();\n        // cc.log(this._spriteDatabase);\n        // cc.log(this.renderTexture);\n        this.renderCamera.node.active = false;\n    },\n\n    turnOffRenderTextureSystem(){\n        this.stopAllNormalSymbolAnimation();\n        this.stopMegaSymbolAnimation();\n        this._isEnable = false;\n    },\n\n    turnOnRenderTextureSystem(){\n        this._isEnable = true;\n    },\n\n    setDefaultPerformance(){\n        this.fps = 60;\n    },\n\n    setLowPerformance(){\n        this.fps = 30;\n    },\n\n    getRTSpriteFrame(symbolCode, skinName = '', isMega = false){\n        let spriteFrame = null;\n        let _symbolCode = symbolCode;\n\n        if(isMega&&this._isEnable){\n            if(symbolCode != this.megaSymbolContainer.currentSymbolCode){\n                this.setUpMegaSymbol(symbolCode);\n            }\n            _symbolCode = 'M';\n        }\n        \n        for(let i = 0; i < this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolCode == _symbolCode && this._isEnable){\n                if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                    this.playNormalSymbolAnimation(_symbolCode, skinName, true);\n                }else{\n                    this.playMegaSymbolAnimation(skinName, true);\n                }\n                spriteFrame = this._spriteDatabase[i].spriteFrame;\n                break;\n            }\n        }\n        return spriteFrame;\n    },\n\n    setUpMegaSymbol(symbolCode){\n        for(let i = 0; i< this.megaSymbolContainer.megaSymbols.length; i++){\n            if(this.megaSymbolContainer.megaSymbols[i].symbolCode == symbolCode){\n                this.megaSymbolContainer.spine.node.active = true;\n                if(this.megaSymbolContainer.currentSymbolCode != symbolCode){\n                    // this.megaSymbolContainer.spine.clearTracks();\n                    this.megaSymbolContainer.spine.skeletonData = null;\n                    this.megaSymbolContainer.spine.skeletonData = this.megaSymbolContainer.megaSymbols[i].skeletonFile;\n                    this.megaSymbolContainer.currentSymbolCode = symbolCode;\n                    this._isPlayingMegaSymbol = false;\n                }\n                break;\n            }\n        }\n    },\n\n    playMegaSymbolAnimation(skinName = '', isloop = true ){\n        this.megaSymbolContainer.spine.node.active = true;\n        this.megaSymbolContainer.spine.paused = false;\n        this.megaSymbolContainer.spine.node.angle = 180;\n        this.megaSymbolContainer.symbolNode.opacity = 255;\n        if(this._isPlayingMegaSymbol == false){\n            if(skinName&&skinName!==''){\n                this.megaSymbolContainer.spine.setSkin(skinName);\n            }\n            this.megaSymbolContainer.spine.setAnimation (0, 'animation', isloop);\n            this._isPlayingMegaSymbol = true;\n        }\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.MEGA){\n                this._spriteDatabase[i].isRendering = true;\n                break;\n            }\n        }\n    },\n\n    stopMegaSymbolAnimation(){\n        // this.megaSymbolContainer.spine.clearTracks();\n        this.megaSymbolContainer.spine.paused = true;\n        this.megaSymbolContainer.spine.node.active = false;\n        this.megaSymbolContainer.symbolNode.opacity = 0;\n        this._isPlayingMegaSymbol = false;\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.MEGA){\n                this._spriteDatabase[i].isRendering = false;\n                break;\n            }\n        }\n    },\n\n    playNormalSymbolAnimation(symbolCode, skinName = '', isloop = true){\n        for(let i = 0; i< this.normalSymbolContainer.symbolList.length; i++){\n            if(this.normalSymbolContainer.symbolList[i].symbolCode == symbolCode){\n                if(this.normalSymbolContainer.symbolList[i].spine){\n                    this.normalSymbolContainer.symbolList[i].spine.node.active = true;\n                    this.normalSymbolContainer.symbolList[i].spine.node.paused = false;\n                    this.normalSymbolContainer.symbolList[i].spine.node.angle = 180;\n                    // this.normalSymbolContainer.symbolList[i].spine.clearTracks();\n                    if(skinName&&skinName!==''){\n                        this.normalSymbolContainer.symbolList[i].spine.setSkin(skinName);\n                    }\n                    this.normalSymbolContainer.symbolList[i].spine.setAnimation(0, 'animation', isloop);\n                }else{\n                    if(this.normalSymbolContainer.symbolList[i].symbolNode.children){\n                        const childNode = this.normalSymbolContainer.symbolList[i].symbolNode.children[0];\n                        if(childNode){\n                            childNode.active = true;\n                        }\n                    }\n                }\n                \n                break;\n            }\n        }\n\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                if(this._spriteDatabase[i].symbolCode == symbolCode){\n                    this._spriteDatabase[i].isRendering = true;\n                    break;\n                }\n            }\n        }\n    },\n\n    stopNormalSymbolAnimation(symbolCode){\n        for(let i = 0; i< this.normalSymbolContainer.symbolList.length; i++){\n            if(this.normalSymbolContainer.symbolList[i].symbolCode == symbolCode){\n                if(this.normalSymbolContainer.symbolList[i].spine){\n                    // this.normalSymbolContainer.symbolList[i].spine.clearTracks();\n                    this.normalSymbolContainer.symbolList[i].spine.node.paused = true;\n                    this.normalSymbolContainer.symbolList[i].spine.node.active = false;\n                }else{\n                    if(this.normalSymbolContainer.symbolList[i].symbolNode.children){\n                        const childNode = this.normalSymbolContainer.symbolList[i].symbolNode.children[0];\n                        if(childNode){\n                            childNode.active = false;\n                        }\n                    }\n                }\n                break;\n            }\n        }\n\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                if(this._spriteDatabase[i].symbolCode == symbolCode){\n                    this._spriteDatabase[i].isRendering = false;\n                    break;\n                }\n            }\n        }\n    },\n\n    playAllNormalSymbolAnimation(isLoop = true){\n        for(let i = 0; i< this.normalSymbolContainer.symbolList.length; i++){\n            \n            if(this.normalSymbolContainer.symbolList[i].spine){\n                this.normalSymbolContainer.symbolList[i].spine.node.active = true;\n                this.normalSymbolContainer.symbolList[i].spine.node.angle = 180;\n                // this.normalSymbolContainer.symbolList[i].spine.clearTracks();\n                this.normalSymbolContainer.symbolList[i].spine.setAnimation(0, 'animation', isLoop);\n            }else{\n                if(this.normalSymbolContainer.symbolList[i].symbolNode.children){\n                    const childNode = this.normalSymbolContainer.symbolList[i].symbolNode.children[0];\n                    if(childNode){\n                        childNode.active = true;\n                    }\n                }\n                \n            }\n        }\n\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                this._spriteDatabase[i].isRendering = true;\n            }\n        }\n    },\n\n    stopAllNormalSymbolAnimation(){\n        for(let i = 0; i< this.normalSymbolContainer.symbolList.length; i++){\n            if(this.normalSymbolContainer.symbolList[i].spine){\n                // this.normalSymbolContainer.symbolList[i].spine.clearTracks();\n                this.normalSymbolContainer.symbolList[i].spine.node.active = false;\n            }else{\n                if(this.normalSymbolContainer.symbolList[i].symbolNode.children){\n                    const childNode = this.normalSymbolContainer.symbolList[i].symbolNode.children[0];\n                    if(childNode){\n                        childNode.active = false;\n                    }\n                }\n            }\n        }\n\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                this._spriteDatabase[i].isRendering = false;\n            }\n        }\n    },\n\n    snapShot(){\n        this.renderTexture.initWithSize(this.rootContainer.width, this.rootContainer.height);\n        this.renderCamera.targetTexture = this.renderTexture;\n        this.renderCamera.render(this.rootContainer);\n        let normalPadding = this.normalSymbolContainer.padding;\n        for(let i = 0; i< this._spriteDatabase.length; i++){\n            if(this._spriteDatabase[i].isRendering == true){\n                if(this._spriteDatabase[i].symbolType == SymbolDataType.NORMAL){\n                    let normalIndex = this._spriteDatabase[i].index;\n                    let width = this._spriteDatabase[i].width;\n                    let height = this._spriteDatabase[i].height;\n                    let colIndex = normalIndex%this.normalSymbolContainer.col;\n                    let rowIndex = Math.floor(normalIndex/this.normalSymbolContainer.col);\n                    let preWidth = colIndex==0?0:this._spriteDatabase[normalIndex-1].width;\n    \n                    let preHeight = (rowIndex==0)?0:this._spriteDatabase[normalIndex - this.normalSymbolContainer.col].height;\n    \n                    let x = normalPadding + (colIndex)* (preWidth + normalPadding);\n                    let y = this.megaSymbolContainer.symbolNode.height+ normalPadding + (rowIndex)* (preHeight + normalPadding);\n                    this._spriteDatabase[i].spriteFrame.setTexture(this.renderTexture, new cc.Rect(x, y, width, height));\n    \n                }else{\n                    let x = (this.megaSymbolContainer.symbolNode.width - this._spriteDatabase[i].width)/2;\n                    let y = 0;\n                    let width = this._spriteDatabase[i].width;\n                    let height = this._spriteDatabase[i].height;\n                    this._spriteDatabase[i].spriteFrame.setTexture(this.renderTexture, new cc.Rect(x, y, width, height));\n                }\n            }\n            \n        }\n    },\n\n    update () {\n        if(this._isEnable == true){\n            this._tick++;\n            if(this._tick>=this._standartFps/this.fps){\n                this._tick = 0;\n                this.snapShot();\n            }\n        }\n    },\n\n    onDestroy(){\n        if(this._spriteDatabase.length>0){\n            for(let i = 0; i<this._spriteDatabase.length; i++){\n                this._spriteDatabase[i] = null;\n            }\n        }\n        this._spriteDatabase = null;\n        if(this.renderCamera!=null){\n            this.renderCamera.targetTexture = null;\n        }\n        if(this.renderTexture!=null){\n            this.renderTexture.destroy();\n        }\n        this.normalSymbolContainer = null;\n        this.megaSymbolContainer = null;\n    }\n});\n"]}