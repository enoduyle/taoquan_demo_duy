{"version":3,"sources":["SlotSymbol.js"],"names":["require","convertAssetArrayToObject","cc","Class","extends","Component","properties","staticSymbol","Node","animIntroPrefab","Prefab","symbols","default","type","SpriteFrame","blurSymbols","onLoad","assets","blurAssets","node","mainComponent","changeToSymbol","bind","changeToBlurSymbol","playAnimation","stopAnimation","blinkHighlight","enableHighlight","disableHighlight","startBlur","stopBlur","reset","addAnimIntro","hideAnimIntro","on","symbolName","asset","symbol","opacity","getComponent","Sprite","spriteFrame","length","bigSymbol","getSymbolName","duration","blinks","action","blink","active","runAction","stopAllActions","blur","emit","anim","animIntro","instantiate","addChild","zIndex","getChildByName","removeAllChildren"],"mappings":"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","file":"SlotSymbol.js","sourceRoot":"../../../../../../../assets/cc-common/cc-slotbase-v2/slotGame/table","sourcesContent":["\n\nconst {convertAssetArrayToObject} = require('utils');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        staticSymbol: cc.Node,\n        animIntroPrefab : cc.Prefab,\n        symbols: {\n            default: [],\n            type: cc.SpriteFrame,\n        }, \n        blurSymbols: [cc.SpriteFrame]\n    },\n\n    onLoad () {\n        this.assets = convertAssetArrayToObject(this.symbols);\n        this.blurAssets = convertAssetArrayToObject(this.blurSymbols);\n        this.node.mainComponent = this;\n        this.node.changeToSymbol = this.changeToSymbol.bind(this);\n        this.node.changeToBlurSymbol = this.changeToBlurSymbol.bind(this);\n        this.node.playAnimation = this.playAnimation.bind(this);\n        this.node.stopAnimation = this.stopAnimation.bind(this);\n        this.node.blinkHighlight = this.blinkHighlight.bind(this);\n        this.node.enableHighlight = this.enableHighlight.bind(this);\n        this.node.disableHighlight = this.disableHighlight.bind(this);\n        this.node.startBlur = this.startBlur.bind(this);\n        this.node.stopBlur = this.stopBlur.bind(this);\n        this.node.reset = this.reset.bind(this);\n        this.node.addAnimIntro = this.addAnimIntro.bind(this);\n        this.node.hideAnimIntro = this.hideAnimIntro.bind(this);\n\n        this.node.on(\"CHANGE_TO_SYMBOL\",this.changeToSymbol,this);\n        this.node.on(\"PLAY_ANIMATION\",this.playAnimation,this);\n        this.node.on(\"STOP_ANIMATION\",this.stopAnimation,this);\n        this.node.on(\"BLINK_HIGHLIGHT\",this.blinkHighlight,this);\n        this.node.on(\"ENABLE_HIGHLIGHT\",this.enableHighlight,this);\n        this.node.on(\"DISABLE_HIGHLIGHT\",this.disableHighlight,this);\n        this.node.on(\"RESET\",this.reset,this);\n    },\n    changeToSymbol(symbolName) {\n        const asset = this.assets[symbolName];\n        this.symbolName = symbolName;\n        if (this.assets[symbolName]) {\n            this.node.symbol = symbolName; // for easy debug\n            this.staticSymbol.opacity = 255;\n            this.staticSymbol.getComponent(cc.Sprite).spriteFrame = asset;\n\n            //Quick check using name convention\n            if (symbolName.length > 3) {\n                this.bigSymbol = true;\n            }\n        } else {\n            this.staticSymbol.opacity = 0;\n        }\n    },\n    getSymbolName() {\n        return this.symbolName;\n    },\n    changeToBlurSymbol(symbolName){\n        if(this.blurAssets[symbolName]){\n            this.node.symbol = symbolName;\n            this.staticSymbol.opacity = 255;\n            this.staticSymbol.getComponent(cc.Sprite).spriteFrame = this.blurAssets[symbolName];\n        }else{\n            this.changeToSymbol(symbolName);\n        }\n    },\n    playAnimation(){},\n    stopAnimation(){\n        if (this.bigSymbol) return;\n\n    },\n    blinkHighlight(duration,blinks){\n        this.node.opacity = 255;\n        if (this.bigSymbol) return;\n\n        var action = cc.blink(duration*blinks,blinks);\n        this.staticSymbol.active = true;\n        this.staticSymbol.runAction(action);\n    },\n    enableHighlight() {\n        this.node.opacity = 255;\n    },\n    disableHighlight() {\n        if (this.bigSymbol) return;\n        //maybe we will handle the big symbol from here, so it will never be dim\n        this.node.opacity = 100;\n    },\n    reset() {\n        this.staticSymbol.stopAllActions();\n        this.staticSymbol.opacity = 255;\n        this.bigSymbol = false;\n        this.node.opacity = 255;\n    },\n    startBlur(blur = 0.1)\n    {\n        this.staticSymbol.emit('ACTIVE_BLUR', blur);\n    },\n    stopBlur()\n    {\n        this.staticSymbol.emit('STOP_BLUR');\n    },\n\n    addAnimIntro(anim){\n        if (!this.animIntro) {\n            this.staticSymbol.opacity = 0;\n            this.animIntro = cc.instantiate(this.animIntroPrefab);\n            this.node.addChild(this.animIntro);\n            this.animIntro.zIndex = this.staticSymbol.zIndex + 1;\n        }\n        this.animIntro.getChildByName('anim').removeAllChildren();\n        this.animIntro.getChildByName('anim').addChild(anim);\n    },\n\n    hideAnimIntro(){\n        if (this.animIntro) {\n            this.animIntro.removeAllChildren();\n            this.animIntro.active = false;\n        }\n        this.staticSymbol.opacity = 255;\n    },\n});\n"]}