{"version":3,"sources":["Turbo.js"],"names":["lodash","require","cc","Class","extends","Component","properties","button","Node","mainDirector","onLoad","node","on","turboToggle","turnOnTurbo","turnOffTurbo","loadTurboConfig","firstLoad","config","gameId","GAME_ID","turboValue","sys","localStorage","getItem","isEmpty","newObj","setItem","JSON","stringify","parse","director","setModeTurbo","setValueTurboConfig","value","trialMode","soundPlayer","playSfxTurboClick","playSFXClick","isCheck","getComponent","Toggle","isChecked","emit"],"mappings":"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","file":"Turbo.js","sourceRoot":"../../../../../../assets/cc-common/cc-slotbase-v2/gui","sourcesContent":["const lodash = require('lodash');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        button: cc.Node,\n        mainDirector: cc.Node,\n    },\n\n    onLoad() {\n        this.node.on(\"TOGGLE_TURBO\",this.turboToggle,this);\n        this.node.on(\"TURN_ON\",this.turnOnTurbo,this);\n        this.node.on(\"TURN_OFF\",this.turnOffTurbo,this);\n        if(this.mainDirector){\n            this.node.mainDirector = this.mainDirector;\n        }\n        this.loadTurboConfig();\n    },\n    loadTurboConfig() {\n        this.firstLoad = true;\n        if (!this.node.config || !this.node.mainDirector) return;\n        const gameId = this.node.config.GAME_ID;\n        let turboValue = cc.sys.localStorage.getItem('turboValueWithGame');\n        if (lodash.isEmpty(turboValue)) {\n            const newObj = {};\n            newObj[gameId] = false;\n            cc.sys.localStorage.setItem('turboValueWithGame', JSON.stringify(newObj));\n        } else {\n            turboValue = JSON.parse(turboValue);\n            if (turboValue[gameId]) {\n                this.node.mainDirector.director.setModeTurbo(true);\n                this.turnOnTurbo();\n            } else {\n                this.node.mainDirector.director.setModeTurbo(false);\n                this.turnOffTurbo();\n            }\n        }\n        this.firstLoad = false;\n    },\n    setValueTurboConfig(value) {\n        if (!this.node.config) return;\n        if (this.node.mainDirector && this.node.mainDirector.director && this.node.mainDirector.director.trialMode) return;\n\n        const gameId = this.node.config.GAME_ID;\n        let turboValue = cc.sys.localStorage.getItem('turboValueWithGame');\n        if (lodash.isEmpty(turboValue)) {\n            const newObj = {};\n            newObj[gameId] = value;\n            cc.sys.localStorage.setItem('turboValueWithGame', JSON.stringify(newObj));\n        } else {\n            turboValue = JSON.parse(turboValue);\n            if (lodash.isEmpty(turboValue)) {\n                const newObj = {};\n                newObj[gameId] = value;\n                cc.sys.localStorage.setItem('turboValueWithGame', JSON.stringify(newObj));\n            } else {\n                turboValue[gameId] = value;\n                cc.sys.localStorage.setItem('turboValueWithGame', JSON.stringify(turboValue));\n            }\n        }\n    },\n    turboToggle() {\n        if (this.node.soundPlayer && !this.firstLoad) {\n            if (typeof this.node.soundPlayer.playSfxTurboClick === 'function') {\n                this.node.soundPlayer.playSfxTurboClick();\n            } else {\n                this.node.soundPlayer.playSFXClick();\n            }\n        }\n        const isCheck = this.button.getComponent(cc.Toggle).isChecked;\n        this.setValueTurboConfig(isCheck);\n        this.node.emit('TURBO_TOGGLE',isCheck);\n    },\n\n    turnOnTurbo() {\n        this.button.getComponent(cc.Toggle).isChecked = true;\n        this.node.emit('TURBO_TOGGLE', true);\n    },\n\n    turnOffTurbo() {\n        this.button.getComponent(cc.Toggle).isChecked = false;\n        this.node.emit('TURBO_TOGGLE', false);\n    },\n});\n"]}