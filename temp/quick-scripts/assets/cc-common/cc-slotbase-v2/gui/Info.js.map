{"version":3,"sources":["Info.js"],"names":["require","changeParent","cc","Class","extends","Component","properties","nextBtn","Node","preBtn","infoTitle","titles","default","type","SpriteFrame","pageViewNode","infoPanel","infoPanelIndex","onLoad","node","on","next","previous","curInfoID","pageView","getComponent","PageView","pageViewEvent","activeButtons","start","setParentInfoPanel","cutscene","mainDirector","director","scheduleOnce","setSiblingIndex","newIndex","getCurrentPageIndex","Math","abs","scrollToPage","soundPlayer","playSFXClick","id","totalInfo","getChildByName","children","length","Button","interactable","Sprite","spriteFrame","Label","textData","string","resetInfo"],"mappings":"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","file":"Info.js","sourceRoot":"../../../../../../assets/cc-common/cc-slotbase-v2/gui","sourcesContent":["\nconst { changeParent } = require(\"utils\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        nextBtn: cc.Node,\n        preBtn: cc.Node,\n        infoTitle: cc.Node,\n        titles: {\n            default: [],\n            type: cc.SpriteFrame,\n        },\n        pageViewNode: cc.Node,\n        infoPanel: cc.Node,\n        infoPanelIndex: 5\n    },\n    onLoad() {\n        this.node.on(\"NEXT_GAME_INFO\", this.next, this);\n        this.node.on(\"PREVIOUS_GAME_INFO\", this.previous, this);\n        this.curInfoID = 0;\n        this.pageView = this.pageViewNode.getComponent(cc.PageView);\n        this.pageView.node.on('page-turning', this.pageViewEvent, this);\n        this.activeButtons(this.curInfoID);\n       \n    },\n\n    start() {\n        this.setParentInfoPanel();\n    },\n\n    setParentInfoPanel() {\n        if (this.infoPanel && this.infoPanelIndex) {\n            let { cutscene } = this.node.mainDirector.director;\n            if (cutscene) {\n                changeParent(this.infoPanel, cutscene);\n                this.scheduleOnce(()=> {\n                    this.infoPanel.setSiblingIndex(this.infoPanelIndex);\n                },0.034);\n                \n            }\n        }\n    },\n\n    pageViewEvent() {\n        let newIndex = this.pageView.getCurrentPageIndex();\n        if (Math.abs(newIndex - this.curInfoID) !== 1) {\n            this.pageView.scrollToPage(this.curInfoID, 0.1);\n            return;\n        }\n        this.curInfoID = newIndex;\n        this.activeButtons(this.curInfoID);\n    },\n\n    next() {\n        if (this.node.soundPlayer) this.node.soundPlayer.playSFXClick();\n        this.pageView.scrollToPage(this.curInfoID + 1);\n        this.curInfoID++;\n        this.activeButtons(this.curInfoID);\n    },\n    previous() {\n        if (this.node.soundPlayer) this.node.soundPlayer.playSFXClick();\n        this.pageView.scrollToPage(this.curInfoID - 1);\n        this.curInfoID--;\n        this.activeButtons(this.curInfoID);\n    },\n    activeButtons(id) {\n        const { nextBtn, preBtn, infoTitle } = this;\n\n        const totalInfo = this.pageView.node.getChildByName('view').getChildByName('content').children.length;\n        if (id >= totalInfo - 1) {\n            id = totalInfo - 1;\n            nextBtn.getComponent(cc.Button).interactable = false;\n        } else {\n            nextBtn.getComponent(cc.Button).interactable = true;\n        }\n\n        if (id <= 0) {\n            id = 0;\n            preBtn.getComponent(cc.Button).interactable = false;\n        } else {\n            preBtn.getComponent(cc.Button).interactable = true;\n        }\n        this.curInfoID = id;\n        if (infoTitle) {\n            if (infoTitle.getComponent(cc.Sprite)) {\n                infoTitle.getComponent(cc.Sprite).spriteFrame = this.titles[this.curInfoID];\n            } else if (infoTitle.getComponent(cc.Label)) {\n                const textData = infoTitle.getComponent('InfoText').textData;\n                infoTitle.getComponent(cc.Label).string = textData[this.curInfoID];\n            }\n        }\n    },\n    resetInfo() {\n        this.pageView.scrollToPage(0, 0);\n        this.curInfoID = 0;\n        this.activeButtons(this.curInfoID);\n    }\n});\n"]}