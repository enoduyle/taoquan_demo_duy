{"version":3,"sources":["../../../../../../assets/cc-taoquan-9983/scripts/cutScene/assets/cc-taoquan-9983/scripts/cutScene/JackpotWinEffect9983.js"],"names":["require","formatMoney","WIN_ANIM","PARTICLE_CONFIG","spawn","interval","minSpeed","maxSpeed","cc","Class","extends","properties","winAnim","Node","winAmount","phaoHoaParticle","phaoHoaLeft","phaoHoaRight","listBGAmount","default","type","SpriteFrame","bgAmount","_coinValue","coinValue","visible","get","set","value","_updateCoinWin","onLoad","_super","soundPlayer","node","rateMega","rateSuper","duration","extendTime","typeWin","getComponent","Label","string","Number","quickShow","winValue","stopAllActions","tweenCoin","stop","hideFn","Button","interactable","tween","to","easing","delay","call","bind","start","enter","config3DParticle","par3D","getChildByName","conf","setSpawnRate","setItemSpeed","setSpawnInterval","show","data","content","Sprite","spriteFrame","jackpotId","currentBetData","jackpotAmount","sp","Skeleton","setSkin","parseInt","setSlotsToSetupPose","setAnimation","showEffectWin","emit","ParticleSystem","resetSystem","active","_tweenCoin","superValue","megaValue","extendDelayTime","gSlotDataStore","isAutoSpin","resetEffectWin","exit","clearTrack","stopSystem","_hideAction","target","stopAction","sequence","delayTime","fadeOut","callFunc","runAction","onDisable"],"mappings":"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","file":"JackpotWinEffect9983.js","sourceRoot":"../../../../../../assets/cc-taoquan-9983/scripts/cutScene","sourcesContent":["const {formatMoney} = require('utils');\nconst WIN_ANIM = {\n    0: 'jackpot_Tai',\n    1: 'jackpot_Loc',\n};\nconst PARTICLE_CONFIG = {\n    0: {spawn: 8, interval: 0.2, minSpeed: 400, maxSpeed: 800},\n    1: {spawn: 6, interval: 0.25, minSpeed: 400, maxSpeed: 750},\n};\n\ncc.Class({\n    extends: require('CutsceneMode'),\n\n    properties: {\n        winAnim: cc.Node,\n        winAmount: cc.Node,\n        phaoHoaParticle: cc.Node,\n        phaoHoaLeft: cc.Node,\n        phaoHoaRight: cc.Node,\n        listBGAmount: {\n            default: [],\n            type: cc.SpriteFrame,\n        },\n        bgAmount: cc.Node,\n        _coinValue: 0,\n        coinValue: {\n            visible: false,\n            get: function () {\n                return this._coinValue;\n            },\n            set: function (value) {\n                this._coinValue = value;\n                this._updateCoinWin();\n            }\n        }\n    },\n\n\n    onLoad() {\n        this._super();\n        this.soundPlayer = (this.node.soundPlayer) ? this.node.soundPlayer : this.node;\n        this.rateMega = 30;\n        this.rateSuper = 50;\n        this.duration = 10;\n        this.extendTime = 14;\n        this.typeWin = 0;\n    },\n\n    _updateCoinWin() {\n        this.winAmount.getComponent(cc.Label).string = formatMoney(Number(this._coinValue));\n    },\n    quickShow() {\n        if (this.coinValue === this.winValue) {\n            this.node.stopAllActions();\n            this.tweenCoin.stop();\n            this.hideFn();\n            return;\n        }\n        this.node.getComponent(cc.Button).interactable = false;\n\n        this.node.stopAllActions();\n        this.tweenCoin.stop();\n        this.tweenCoin = cc.tween(this)\n            .to(0.8, {coinValue: this.winValue}, {easing: \"quadOut\"})\n            .delay(1)\n            .call(this.hideFn.bind(this))\n            .start();\n      \n    },\n\n    enter() {\n    },\n    config3DParticle(type){\n        let par3D = this.node.getChildByName('3dParticle');\n        let conf = PARTICLE_CONFIG[type];\n        par3D.setSpawnRate(conf.spawn);\n        par3D.setItemSpeed(conf.minSpeed, conf.maxSpeed);\n        par3D.setSpawnInterval(conf.interval);\n    },\n\n    show() {\n        this._super();\n        let data = this.content;\n        this.bgAmount.getComponent(cc.Sprite).spriteFrame = this.listBGAmount[data.jackpotId];\n        this.currentBetData = data.currentBetData;\n        this.winValue = data.jackpotAmount;\n        this.winAnim.getComponent(sp.Skeleton).setSkin(WIN_ANIM[parseInt(data.jackpotId)]);\n        this.winAnim.getComponent(sp.Skeleton).setSlotsToSetupPose();\n        this.winAnim.getComponent(sp.Skeleton).setAnimation(0, 'animation', true);\n        this.config3DParticle(parseInt(data.jackpotId));\n        this.showEffectWin();\n    },\n\n    showEffectWin() {\n        this.soundPlayer.node.emit(\"STOP_ALL_AUDIO\");\n        this.soundPlayer.node.emit(\"PLAY_WIN_LOOP\");\n\n        this.phaoHoaParticle.getComponent(cc.ParticleSystem).resetSystem();\n        this.phaoHoaLeft.active = true;\n        this.phaoHoaRight.active = true;\n        this.phaoHoaLeft.getComponent(sp.Skeleton).setAnimation(0, 'animation', true);\n        this.phaoHoaRight.getComponent(sp.Skeleton).setAnimation(0, 'animation', true);\n        cc.tween(this.node)\n            .delay(0.5)\n            .call(() => {\n                this.node.getComponent(cc.Button).interactable = true;\n            })\n            .start();\n        this._tweenCoin(this.winValue);\n    },\n\n    /**\n     * @effect\n     **/\n    _tweenCoin(winAmount) {\n        let superValue = this.winValue * 0.75;\n        let megaValue = this.winValue * 0.5;\n        const extendDelayTime = this.node.gSlotDataStore && this.node.gSlotDataStore.isAutoSpin ? this.extendTime : 0;\n        this.tweenCoin = cc.tween(this)\n            .to(this.duration / 3, {coinValue: megaValue}, {easing: \"sineInOut\"})\n            .to(this.duration / 3, {coinValue: superValue}, {easing: \"sineInOut\"})\n            .to(this.duration / 3, {coinValue: winAmount}, {easing: \"sineInOut\"})\n            .delay(extendDelayTime)\n            .call(() => {\n                if (this.node.gSlotDataStore && this.node.gSlotDataStore.isAutoSpin) {\n                    this.hideFn();\n                }\n            });\n        this.tweenCoin.start();\n       \n    },\n\n    resetEffectWin() {\n      \n        let par3D = this.node.getChildByName('3dParticle');\n        this.config3DParticle(0);\n        par3D.exit();\n\n        this.coinValue = 0;\n        this.typeWin = 0;\n        this.winAmount.getComponent(cc.Label).string = \"\";\n        this.winAnim.getComponent(sp.Skeleton).clearTrack(0);\n        this.phaoHoaParticle.getComponent(cc.ParticleSystem).stopSystem();\n        this.phaoHoaLeft.active = false;\n        this.phaoHoaRight.active = false;\n\n\n        if(this._hideAction!=null && this._hideAction.target!=null){\n            this.node.stopAction(this._hideAction);\n            this._hideAction = null;\n        }\n    },\n\n    hideFn() {\n        this._hideAction = cc.sequence(\n            cc.delayTime(0.5),\n            cc.fadeOut(0.5),\n            cc.callFunc(() => {\n                this.soundPlayer.node.emit(\"STOP_WIN_LOOP\");\n                this.soundPlayer.node.emit(\"PLAY_SOUND_BACKGROUND\");\n                this.resetEffectWin();\n                this.exit();\n            }),\n        );\n        this.node.runAction(this._hideAction);\n    },\n\n    onDisable() {\n        this.node.stopAllActions();\n        if (this.tweenCoin) {\n            this.tweenCoin.stop();\n        }\n    }\n});\n"]}