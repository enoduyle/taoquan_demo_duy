{"version":3,"sources":["../../../../../../assets/cc-taoquan-9983/scripts/cutScene/assets/cc-taoquan-9983/scripts/cutScene/OptionController9983.js"],"names":["Y_START","Y_END","START_HEIGHT","cc","Class","extends","Component","properties","spinNumber","Node","wildSpine","wildMultiply","background","scrollTop","scrollBottom","mask","topMysteryChoice","botMysteryChoice","onLoad","node","on","updateData","playRollAnimation","reset","initMystery","resetMystery","rollMystery","stopMystery","canClickOption","active","value","canClick","attachEvent","data","selectOptionCallback","clickEventHandler","EventHandler","target","component","handler","button","getComponent","Button","clickEvents","push","callback","sp","Skeleton","setAnimation","index","scroll","spinImageList","wildMultiplyImageList","Sprite","spriteFrame","setSkin","setSlotsToSetupPose","tweenMask","tween","to","height","start","runAction","moveTo","v2","x","y","opacity","clearTracks","topSymbols","botSymbols","emit","multiId","spinTimeId"],"mappings":"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","file":"OptionController9983.js","sourceRoot":"../../../../../../assets/cc-taoquan-9983/scripts/cutScene","sourcesContent":["const Y_START = 102;\nconst Y_END = -140;\nconst START_HEIGHT = 40;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        spinNumber: cc.Node,\n        wildSpine: cc.Node,\n        wildMultiply: cc.Node,\n        background: cc.Node,\n        scrollTop: cc.Node,\n        scrollBottom: cc.Node,\n        mask: cc.Node,\n        topMysteryChoice: cc.Node,\n        botMysteryChoice: cc.Node,\n    },\n\n    onLoad () {\n        this.node.on(\"UPDATE_OPTION_DATA\", this.updateData, this);\n        this.node.on(\"SCROLLING_ROLL\", this.playRollAnimation, this);\n        this.node.on(\"RESET_DATA\", this.reset, this);\n        this.node.on('INIT_MYSTERY', this.initMystery, this);\n        this.node.on('RESET_MYSTERY', this.resetMystery, this);\n        this.node.on('ROLL_MYSTERY', this.rollMystery, this);\n        this.node.on('STOP_MYSTERY', this.stopMystery, this);\n        this.node.on('CAN_CLICK', this.canClickOption, this);\n        if (this.wildSpine) {\n            this.wildSpine.active = false;\n        }\n        this.topMysteryChoice.active = false;\n        this.botMysteryChoice.active = false;\n    },\n\n    canClickOption(value){\n        this.canClick = value;\n    },\n\n    attachEvent(data, selectOptionCallback) {\n        let clickEventHandler = new cc.Component.EventHandler();\n        clickEventHandler.target = this.node;\n        clickEventHandler.component = \"OptionController9983\";\n        clickEventHandler.handler = \"callback\";\n        this.data = data;\n        this.selectOptionCallback = selectOptionCallback;\n\n        var button = this.node.getComponent(cc.Button);\n        button.clickEvents.push(clickEventHandler);\n    },\n\n    callback () {\n        if(!this.canClick) return;\n        this.canClick = false;\n        this.wildSpine.active = true;\n        this.wildSpine.getComponent(sp.Skeleton).setAnimation(0, 'animation', false);\n        this.selectOptionCallback(this.data);\n    },\n\n    updateData({spinNumber, index, wildMultiply, background, scroll, spinImageList, wildMultiplyImageList}) {\n        this.background.getComponent(cc.Sprite).spriteFrame = background;\n        this.spinNumber.getComponent(cc.Sprite).spriteFrame = spinNumber;\n        this.wildMultiply.getComponent(cc.Sprite).spriteFrame = wildMultiply;\n        this.scrollTop.getComponent(cc.Sprite).spriteFrame = scroll;\n        this.scrollBottom.getComponent(cc.Sprite).spriteFrame = scroll;\n        this.wildSpine.getComponent(sp.Skeleton).setSkin(`skin${index}`);\n        this.wildSpine.getComponent(sp.Skeleton).setSlotsToSetupPose();\n        this.index = index;\n        if(index == 7) {\n            this.topMysteryChoice.active = true;\n            this.botMysteryChoice.active = true;\n            this.initMystery(spinImageList, wildMultiplyImageList);\n        }\n    },\n\n    playRollAnimation() {\n        this.tweenMask = cc.tween(this.mask).to(0.8, {height: this.background.height});\n        this.tweenMask.start();\n        this.scrollBottom.runAction(cc.moveTo(0.8, cc.v2(this.scrollBottom.x, Y_END)));\n    },\n\n    reset() {\n        this.canClick = false;\n        this.mask.height = START_HEIGHT;\n        this.scrollTop.y = -Y_END;\n        this.scrollBottom.y = Y_START;\n        this.node.opacity = 255;\n        this.wildSpine.active = false;\n        this.wildSpine.getComponent(sp.Skeleton).clearTracks();\n    },\n\n    initMystery(topSymbols, botSymbols){\n        this.topMysteryChoice.emit('INIT', topSymbols);\n        this.botMysteryChoice.emit('INIT', botSymbols);\n    },\n\n    rollMystery(){\n        if(this.index != 7) return;\n        this.topMysteryChoice.emit('MYSTERY_CHOICE');\n        this.botMysteryChoice.emit('MYSTERY_CHOICE');\n    },\n\n    resetMystery(){\n        this.topMysteryChoice.emit('RESET');\n        this.botMysteryChoice.emit('RESET');\n    },\n\n    stopMystery(multiId, spinTimeId, callback){\n        this.topMysteryChoice.emit('STOP_ROLL', spinTimeId);\n        this.botMysteryChoice.emit('STOP_ROLL', multiId, callback);\n    }\n});\n"]}