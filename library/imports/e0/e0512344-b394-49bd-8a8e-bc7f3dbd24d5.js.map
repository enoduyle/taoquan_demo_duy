{"version":3,"sources":["../../../../../../../assets/cc-common/cc-share-v1/shader/shaderEffect/assets/cc-common/cc-share-v1/shader/shaderEffect/vintageFadeIn.js"],"names":["START_R_M","MAX_BLUR_STR","cc","Class","extends","Component","properties","transitionDur","blurDur","onLoad","init","node","activeTransition","bind","startFadeIn","stopBlur","sprite","getComponent","Sprite","material","getMaterial","timePassed","blurStr","setProperty","runAction","sequence","delayTime","callFunc","update","transitionActived","radiusMultiple","Math","max","tween","to","easing","start"],"mappings":";;;;;;AAAA,IAAMA,YAAY,EAAlB;AACA,IAAMC,eAAe,KAArB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,uBAAe,GADP;AAERC,iBAAS;AAFD,KAHP;;AAQLC,UARK,oBAQG;AACJ,aAAKC,IAAL;AACA,aAAKC,IAAL,CAAUC,gBAAV,GAA6B,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAA7B;AACA,aAAKF,IAAL,CAAUG,WAAV,GAAwB,KAAKA,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAAxB;AACA,aAAKF,IAAL,CAAUI,QAAV,GAAqB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAArB;AACH,KAbI;AAeLH,QAfK,kBAeG;AACJ,YAAMM,SAAS,KAAKL,IAAL,CAAUM,YAAV,CAAuBf,GAAGgB,MAA1B,CAAf;AACA,YAAGF,MAAH,EAAW;AACP,iBAAKG,QAAL,GAAgBH,OAAOI,WAAP,CAAmB,CAAnB,CAAhB;AACH;AACD,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,OAAL,GAAerB,YAAf;AACA,aAAKkB,QAAL,CAAcI,WAAd,CAA0B,UAA1B,EAAsCtB,YAAtC;AACA,aAAKkB,QAAL,CAAcI,WAAd,CAA0B,gBAA1B,EAA4C,IAA5C;AACH,KAxBI;AA0BLX,oBA1BK,8BA0Ba;AAAA;;AACd,aAAKE,WAAL;AACA,aAAKH,IAAL,CAAUa,SAAV,CAAoBtB,GAAGuB,QAAH,CAChBvB,GAAGwB,SAAH,CAAa,KAAKnB,aAAlB,CADgB,EAEhBL,GAAGyB,QAAH,CAAY,YAAI;AACZ,kBAAKZ,QAAL;AACH,SAFD,CAFgB,CAApB;AAMH,KAlCI;AAoCLa,UApCK,oBAoCK;AACN,YAAG,CAAC,KAAKT,QAAT,EAAmB;AACnB,aAAKA,QAAL,CAAcI,WAAd,CAA0B,UAA1B,EAAsC,KAAKD,OAA3C;AACA,YAAG,KAAKO,iBAAR,EAA2B;AACvB,gBAAMC,iBAAiBC,KAAKC,GAAL,CAAS,GAAT,EAAchC,YAAY,KAAKqB,UAA/B,CAAvB;AACA,iBAAKF,QAAL,CAAcI,WAAd,CAA0B,gBAA1B,EAA4CO,cAA5C;AACH;AACJ,KA3CI;AA6CLhB,eA7CK,yBA6CQ;AACT,aAAKJ,IAAL;AACA,aAAKmB,iBAAL,GAAyB,IAAzB;AACA,aAAKR,UAAL,GAAkB,CAAlB;AACAnB,WAAG+B,KAAH,CAAS,IAAT,EACKC,EADL,CACQ,KAAK3B,aADb,EAC4B,EAACc,YAAYrB,SAAb,EAD5B,EACqD,EAACmC,QAAQ,UAAT,EADrD,EAEKC,KAFL;AAGH,KApDI;AAsDLrB,YAtDK,sBAsDK;AACNb,WAAG+B,KAAH,CAAS,IAAT,EACKC,EADL,CACQ,KAAK1B,OADb,EACsB,EAACc,SAAS,CAAV,EADtB,EAEKc,KAFL;AAGA;AACH;AA3DI,CAAT","file":"vintageFadeIn.js","sourceRoot":"../../../../../../../assets/cc-common/cc-share-v1/shader/shaderEffect","sourcesContent":["const START_R_M = 30;\nconst MAX_BLUR_STR = 0.125;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        transitionDur: 1.0,\n        blurDur: 0.5,\n    },\n\n    onLoad(){\n        this.init();\n        this.node.activeTransition = this.activeTransition.bind(this);\n        this.node.startFadeIn = this.startFadeIn.bind(this);\n        this.node.stopBlur = this.stopBlur.bind(this);\n    },\n\n    init () {\n        const sprite = this.node.getComponent(cc.Sprite);\n        if(sprite) {\n            this.material = sprite.getMaterial(0);\n        }\n        this.timePassed = 0;\n        this.blurStr = MAX_BLUR_STR;\n        this.material.setProperty('Strength', MAX_BLUR_STR);\n        this.material.setProperty('radiusMultiple', 9999);\n    },\n\n    activeTransition(){\n        this.startFadeIn();\n        this.node.runAction(cc.sequence(\n            cc.delayTime(this.transitionDur),\n            cc.callFunc(()=>{\n                this.stopBlur();\n            })\n        ));\n    },\n\n    update () {\n        if(!this.material) return;\n        this.material.setProperty('Strength', this.blurStr);\n        if(this.transitionActived) {\n            const radiusMultiple = Math.max(0.0, START_R_M - this.timePassed);\n            this.material.setProperty('radiusMultiple', radiusMultiple);\n        }\n    },\n\n    startFadeIn(){\n        this.init();\n        this.transitionActived = true;\n        this.timePassed = 0;\n        cc.tween(this)\n            .to(this.transitionDur, {timePassed: START_R_M}, {easing: 'cubicOut'})\n            .start();\n    },\n\n    stopBlur(){\n        cc.tween(this)\n            .to(this.blurDur, {blurStr: 0})\n            .start();\n        // this.node.runAction(cc.scaleTo(this.transitionDur, 3));\n    }\n});\n"]}