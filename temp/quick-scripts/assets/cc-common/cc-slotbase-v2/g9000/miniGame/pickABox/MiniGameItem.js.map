{"version":3,"sources":["MiniGameItem.js"],"names":["require","tweenObject","cc","Class","extends","Component","properties","symbolPrefab","Prefab","onLoad","node","mainComponent","init","arguments","data","callbackMiniGame","itemValue","symbol","createSymbol","parent","scriptItem","getComponent","attachEvent","currentSymbol","instantiate","initLoopingAnimation","lightEff","getChildByName","treasureLit","dur","easing","easeBackInOut","initY","y","repeater","repeatForever","sequence","DelayTime","Math","random","moveTo","v2","x","runAction","lightingInterVal","setInterval","angle","replaceSpriteFrame","spriteFrame","bonus","assets","count","callback","bonusNode","particalEff","score","easeSineOut","Sprite","active","scaleX","scaleY","stopAllActions","isShowScore","easeBackOut","stopAllAnimation","destroy","opacity","replaceWithText","Label","string","undefined","clearInterval"],"mappings":"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","file":"MiniGameItem.js","sourceRoot":"../../../../../../../../assets/cc-common/cc-slotbase-v2/g9000/miniGame/pickABox","sourcesContent":["\n\nconst { tweenObject } = require('globalAnimationLibrary');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        symbolPrefab: cc.Prefab,\n    },\n\n    onLoad() {\n        this.node.mainComponent = this;\n    },\n\n    init() {\n        const {data, callbackMiniGame, itemValue } = arguments[0];\n        const symbol = this.createSymbol(this.symbolPrefab);\n        symbol.parent = this.node;\n        this.itemValue = itemValue;\n        const scriptItem = symbol.getComponent('gSlotMiniGameScript');\n        scriptItem.attachEvent(data, callbackMiniGame);\n        this.currentSymbol = symbol;\n\n        return symbol;\n    },\n\n    createSymbol() {\n        let symbol = cc.instantiate(this.symbolPrefab);\n        // const item = symbol.getChildByName('Treasure');\n        // symbol.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n        return symbol;\n    },\n\n    initLoopingAnimation() {\n        const lightEff = this.currentSymbol.getChildByName('LightEff');\n        const treasureLit = this.currentSymbol.getChildByName('TreasureLit');\n        const dur = .3;\n        const easing = cc.easeBackInOut();\n        \n        treasureLit.initY = treasureLit.y;\n        const repeater = cc.repeatForever(cc.sequence(\n            new cc.DelayTime(Math.random()),\n            cc.moveTo(dur, cc.v2(treasureLit.x, treasureLit.y + 5)).easing(easing),\n            cc.moveTo(dur, cc.v2(treasureLit.x, treasureLit.initY)).easing(easing)\n        ));\n        treasureLit.runAction(repeater);\n\n        //\n        this.lightingInterVal = setInterval(() => {\n            lightEff.getChildByName('light').angle -= .2;\n        }, 60 / 100); \n    },\n\n    replaceSpriteFrame(spriteFrame, bonus, assets, count,callback) {\n        this.itemValue = bonus;\n       \n        const treasureLit = this.currentSymbol.getChildByName('TreasureLit');\n        // const treasureTop = this.currentSymbol.getChildByName('TreasureTop');\n        const bonusNode = this.currentSymbol.getChildByName('Bonus');\n        const lightEff = this.currentSymbol.getChildByName('LightEff');\n        const particalEff = this.currentSymbol.getChildByName('ParticalEff');\n        const score = this.currentSymbol.getChildByName('Score');\n        \n\n        let dur = .3;\n        const easing = cc.easeSineOut();\n        \n        score.getComponent(cc.Sprite).spriteFrame = assets['miniGame-' + bonus];\n        score.active = true;\n\n        \n        lightEff.active = true;\n        lightEff.getChildByName('light').getComponent(cc.Sprite).spriteFrame = assets['LIGHT-' + bonus];\n\n        bonusNode.scaleX = bonusNode.scaleY = .5;\n        bonusNode.active = true;\n        bonusNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\n        treasureLit.stopAllActions();\n        this.isShowScore = false;\n\n        if (bonus && count <= 3) {\n            this.isShowScore = true;\n            score.scaleX = score.scaleY = 0;\n            tweenObject(lightEff, { \"dur\": dur, \"dy\": 150, \"scale\": 1, \"easing\": easing });\n            tweenObject(treasureLit, { \"dur\": dur, \"dx\": 180, \"dy\": 260, \"rotate\": -30, \"opacity\": 0, \"easing\": easing });\n            tweenObject(score, { \"dur\": dur, \"delay\": .1, \"scale\": 1, \"easing\": cc.easeBackOut() });\n        } else {\n            dur = 0;\n            this.stopAllAnimation();\n            particalEff.destroy();\n            treasureLit.destroy();\n            lightEff.destroy();\n            this.currentSymbol.opacity = 140;\n        }\n\n        tweenObject(bonusNode, {\"dur\": dur, \"dy\": 60, \"scale\": 1, \"easing\": easing, \"callback\": () => {\n            if (this.isShowScore) {\n                if (callback && typeof callback === 'function') {\n                    callback(bonus,this);\n                }\n            }\n        }});\n    },\n\n    replaceWithText(bonus) {\n        this.itemValue = bonus;\n        if (bonus) {\n            this.currentSymbol.getComponent(cc.Sprite).spriteFrame = null;\n            this.currentSymbol.getChildByName('LabelNumber').getComponent(cc.Label).string = bonus;\n        }\n    },\n\n    stopAllAnimation() {\n        if (this.lightingInterVal !== undefined) {\n            clearInterval(this.lightingInterVal);\n        }\n    },\n});\n"]}