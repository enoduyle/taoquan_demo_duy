{"version":3,"sources":["SlotTablev2.js"],"names":["cc","Class","extends","require","properties","stickyWildNode","Node","onLoad","table","node","on","init","setMode","startSpinning","stopSpinning","fastToResult","changeMatrix","updateSymbolList","stopReelRoll","stopReeWithRandomMatrix","showStaticSymbol","gameExit","playAnimDebug","forceResetTableEffect","mode","config","SHOW_BEAUTY_MATRIX","hideAnimIntro","bind","showAnimIntro","isFastToResult","isFreeMode","curentConfig","STATS","reels","tableFormat","TABLE_FORMAT","col","length","reel","instantiate","reelPrefab","name","parent","mainComponent","symbolPrefab","setPosition","getXPosition","stickyWild","getChildByName","emit","ranInt","getRandomMatrixIndex","strM","BEAUTY_MATRIX","index","startX","SYMBOL_WIDTH","matrix","rowOffset","row","symbol","showSymbols","changeToSymbol","startSpinningWithDelay","callback","matrixRandom","getRandomSymbolNameWithExceptions","value","forEach","getComponent","symbolList","data","bigSymbols","stopSpinningCallbackCount","currentCol","symbolValue","push","stopSpinningWithDelay","checkStopSpinningCallback","context","count","skipAnimation","gSlotDataStore","gameSpeed","fastStopSpinning","isShow","staticSymbol","opacity","getBeautyMatrixRandom","split","lastMatrix","convertSlotMatrix","bt","updateSymbols","Math","floor","random","findStoredRndIndex","strKey","GAME_ID","res","sys","localStorage","getItem","JSON","parse","setItem","undefined","stringify"],"mappings":"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","file":"SlotTablev2.js","sourceRoot":"../../../../../../../assets/cc-common/cc-slotbase-v2/slotGame/table","sourcesContent":["cc.Class({\n  extends: require('SlotTable'),\n\n  properties: {\n    stickyWildNode: cc.Node,\n  },\n\n  onLoad() {\n    if (!this.table) this.table = this.node;\n\n    this.node.on('INIT', this.init, this);\n    this.node.on('SET_MODE', this.setMode, this);\n    this.node.on('START_SPINNING', this.startSpinning, this);\n    this.node.on('STOP_SPINNING', this.stopSpinning, this);\n    this.node.on('FAST_TO_RESULT', this.fastToResult, this);\n    this.node.on('CHANGE_MATRIX', this.changeMatrix, this);\n    this.node.on('UPDATE_SYMBOL_LIST', this.updateSymbolList, this);\n    this.node.on('STOP_REEL_ROOL', this.stopReelRoll, this);\n    this.node.on(\n      'STOP_REEL_WITH_RANDOM_MATRIX',\n      this.stopReeWithRandomMatrix,\n      this\n    );\n    this.node.on('SHOW_STATIC_SYMBOL', this.showStaticSymbol, this);\n    this.node.on('GAME_EXIT', this.gameExit, this);\n    this.node.on('PLAY_ANIM_DEBUG', this.playAnimDebug, this);\n    this.node.on('FORCE_RESET_TABLE_EFFECT', this.forceResetTableEffect, this);\n    this.node.mode = 'FAST';\n    if (this.node.config.SHOW_BEAUTY_MATRIX) {\n      this.node.on('HIDE_ANIM_INTRO', this.hideAnimIntro.bind(this));\n      this.node.on('SHOW_ANIM_INTRO', this.showAnimIntro.bind(this));\n    }\n  },\n  init() {\n    this.isFastToResult = false;\n    this.node.isFreeMode = this.isFreeMode;\n    this.node.curentConfig = this.node.config.STATS[this.node.mode];\n    this.node.reels = [];\n    this.tableFormat = this.node.config.TABLE_FORMAT;\n    for (let col = 0; col < this.tableFormat.length; ++col) {\n      const reel = cc.instantiate(this.reelPrefab);\n      //Must attach to node so component can be loadded\n      reel.name = 'Reel_' + col;\n      reel.parent = this.table;\n      //Then we can use this\n      reel.mainComponent.init(\n        this.tableFormat[col],\n        this.node.config,\n        col,\n        this.symbolPrefab,\n        this.isFreeMode\n      );\n      reel.setPosition(this.getXPosition(col), 0);\n      this.node.reels[col] = reel.mainComponent;\n    }\n\n    this.stickyWild =\n      this.stickyWildNode || this.node.getChildByName('StickyWild');\n    if (this.stickyWild) {\n      this.stickyWild.emit('INIT', this);\n    }\n    if (this.node.config.SHOW_BEAUTY_MATRIX && this.isFreeMode == false) {\n      let ranInt = this.getRandomMatrixIndex();\n      this.strM = this.node.config.BEAUTY_MATRIX[ranInt];\n      this.showAnimIntro();\n    }\n  },\n  getXPosition(index) {\n    let startX =\n      -(this.tableFormat.length / 2 - 0.5) * this.node.config.SYMBOL_WIDTH;\n    return startX + this.node.config.SYMBOL_WIDTH * index;\n  },\n  setMode(mode) {\n    this.node.mode = mode;\n  },\n  changeMatrix({ matrix, rowOffset = 0 }) {\n    this.matrix = matrix;\n    for (let col = 0; col < this.tableFormat.length; ++col) {\n      const reel = this.node.reels[col];\n      for (let row = 0; row < this.tableFormat[col]; ++row) {\n        if (reel) {\n          const symbol = reel.showSymbols[row + rowOffset];\n          if (symbol) symbol.changeToSymbol(this.matrix[col][row]);\n        }\n      }\n    }\n    if (this.stickyWild) {\n      this.stickyWild.emit('CHANGE_MATRIX', matrix);\n    }\n  },\n  stopReelRoll() {\n    for (let col = 0; col < this.node.reels.length; ++col) {\n      this.node.reels[col].stopReelRoll();\n    }\n  },\n  startSpinning() {\n    this.isFastToResult = false;\n    this.node.curentConfig = this.node.config.STATS[this.node.mode];\n    for (let col = 0; col < this.node.reels.length; ++col) {\n      this.node.reels[col].setMode(this.node.mode);\n      this.node.reels[col].startSpinningWithDelay(col);\n    }\n    this.node.emit('TABLE_START_NEARWIN');\n    this.node.emit('TABLE_START_SOUND');\n    this.node.emit('TABLE_START_EFFECT');\n    this.node.emit('TABLE_START_MISC');\n  },\n  stopReeWithRandomMatrix(callback) {\n    this.matrixRandom = [];\n    for (let col = 0; col < this.tableFormat.length; ++col) {\n      this.matrixRandom[col] = [];\n      for (let row = this.tableFormat[col] - 1; row >= 0; --row) {\n        const reel = this.node.reels[col];\n        if (reel && reel.getRandomSymbolNameWithExceptions) {\n          this.matrixRandom[col][row] = reel.getRandomSymbolNameWithExceptions([\n            'A',\n            'R',\n            'K',\n          ]);\n        } else {\n          this.matrixRandom[col][row] = '3';\n        }\n      }\n    }\n    this.stopSpinning(this.matrixRandom, () => {\n      callback && callback();\n    });\n  },\n  updateSymbolList(value) {\n    this.node.reels.forEach(reel => {\n      reel.getComponent('SlotReel').symbolList = value;\n    });\n  },\n  stopSpinning(data, callback) {\n    this.matrix = data;\n    this.node.bigSymbols = [];\n    this.stopSpinningCallbackCount = 0;\n\n    for (let col = 0; col < this.tableFormat.length; ++col) {\n      const currentCol = this.matrix[col];\n      let matrix = [];\n      for (let row = currentCol.length - 1; row >= 0; --row) {\n        let symbolValue = currentCol[row];\n\n        this.node.emit('CHECK_MEGA_SYMBOL', symbolValue, col, row);\n\n        matrix.push(symbolValue);\n      }\n      this.node.reels[col].stopSpinningWithDelay(\n        col,\n        matrix,\n        this.checkStopSpinningCallback.bind(this, matrix, callback)\n      );\n    }\n\n    if (this.table) {\n      this.table.bigSymbols = this.node.bigSymbols;\n    }\n\n    this.node.emit('REEL_ABOUT_TO_STOP_NEARWIN', {\n      reels: this.node.reels,\n      data,\n      context: this,\n    });\n    this.node.emit('REEL_ABOUT_TO_STOP_SOUND', {\n      reels: this.node.reels,\n      data,\n      context: this,\n    });\n    this.node.emit('REEL_ABOUT_TO_STOP_EFFECT', {\n      reels: this.node.reels,\n      data,\n      context: this,\n    });\n    this.node.emit('REEL_ABOUT_TO_STOP_MISC', {\n      reels: this.node.reels,\n      data,\n      context: this,\n    });\n    if (this.stickyWild) {\n      this.stickyWild.emit('UPDATE_MATRIX', this.matrix);\n    }\n  },\n  checkStopSpinningCallback(matrix, callback) {\n    this.stopSpinningCallbackCount++;\n    const count = this.stopSpinningCallbackCount;\n\n    if (\n      count >= this.node.reels.length &&\n      callback &&\n      typeof callback == 'function'\n    ) {\n      callback();\n    }\n\n    this.node.emit('REEL_STOP_NEARWIN', { matrix, count, context: this });\n    this.node.emit('REEL_STOP_SOUND', { matrix, count, context: this });\n    this.node.emit('REEL_STOP_EFFECT', { matrix, count, context: this });\n    this.node.emit('REEL_STOP_MISC', { matrix, count, context: this });\n    if (this.stickyWild) {\n      const skipAnimation = this.node.parent.gSlotDataStore.gameSpeed > 1;\n      this.stickyWild.emit('SHOW_STICKY_WILD', count - 1, skipAnimation);\n    }\n  },\n  fastToResult() {\n    if (this.stopSpinningCallbackCount < this.node.reels.length) {\n      this.isFastToResult = true;\n      for (let col = 0; col < this.node.reels.length; ++col) {\n        this.node.reels[col].fastStopSpinning();\n      }\n    }\n  },\n  gameExit() {\n    if (this.stickyWild) {\n      this.stickyWild.emit('RESET');\n    }\n  },\n\n  showStaticSymbol(col, row, symbol, isShow) {\n    if (\n      !this.node.reels ||\n      !this.node.reels[col] ||\n      !this.node.reels[col].showSymbols\n    )\n      return;\n    const staticSymbol = this.node.reels[col].showSymbols[row];\n    if (staticSymbol && staticSymbol.symbol === symbol) {\n      staticSymbol.opacity = isShow ? 255 : 0;\n    }\n  },\n\n  playAnimDebug() {\n    this.node.emit('SETUP_PAYLINES', this.matrixRandom);\n  },\n\n  getBeautyMatrixRandom() {\n    let matrix = this.strM.split(',');\n    let lastMatrix = this.node.gSlotDataStore.convertSlotMatrix(\n      matrix,\n      this.node.config.TABLE_FORMAT\n    );\n    return lastMatrix;\n  },\n\n  showAnimIntro() {\n    if (!this.isFreeMode && this.node.config.SHOW_BEAUTY_MATRIX) {\n      let bt = this.getBeautyMatrixRandom();\n      this.node.reels.forEach((reel, index) => {\n        reel.updateSymbols(bt[index]);\n      });\n    }\n  },\n\n  hideAnimIntro() {\n    this.node.reels.forEach(reel => {\n      reel.hideAnimIntro();\n    });\n  },\n\n  getRandomMatrixIndex() {\n    let ranInt = 0;\n    let length = this.node.config.BEAUTY_MATRIX.length;\n    do {\n      ranInt = Math.floor(Math.random() * length);\n    } while (this.findStoredRndIndex(ranInt));\n    return ranInt;\n  },\n\n  findStoredRndIndex(ranInt) {\n    let length = this.node.config.BEAUTY_MATRIX.length;\n    const strKey = this.node.config.GAME_ID + 'rndIntroMatrixArray';\n    let res = cc.sys.localStorage.getItem(strKey);\n    if (res != null) res = JSON.parse(res);\n    if (res == null || res.length >= length) {\n      cc.sys.localStorage.setItem(strKey, { length: 0 });\n      res = { length: 0 };\n    }\n\n    if (res[ranInt] == undefined) {\n      res[ranInt] = ranInt;\n      res.length++;\n      cc.sys.localStorage.setItem(strKey, JSON.stringify(res));\n      return false;\n    }\n    return true;\n  },\n\n  forceResetTableEffect() {\n    // override code\n  },\n});\n"]}