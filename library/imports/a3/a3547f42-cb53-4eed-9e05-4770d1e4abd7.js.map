{"version":3,"sources":["../../../../../../assets/cc-common/cc-slotbase-v2/component/assets/cc-common/cc-slotbase-v2/component/Index.js"],"names":["connect","require","cc","Class","extends","Component","properties","onLoad","node","index","sys","isBrowser","_updateLanguageConfig","start","director","gameId","config","GAME_ID","gSlotDataStore","init","_isOnStarted","update","initGameMode","autoConnect","loginScene","callback","bind","gameNode","callbackAuthFailed","authFailed","setUpGame","showMessageAuthFailed","languageCode","_getLanguage","window","getUrlParam","loadConfigAsync","getConfig","LOGIN_IFRAME","defaultLanguage","language","CC_PREVIEW","folderLanguage","settings","undefined","localStorage","getItem","toUpperCase","onDestroy","isNative","closeCreatorGame","audioEngine","stopAll","gameStateManager","outGame"],"mappings":"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","file":"Index.js","sourceRoot":"../../../../../../assets/cc-common/cc-slotbase-v2/component","sourcesContent":["\n\nconst connect = require('connectNetwork');\ncc.Class({\n    extends: cc.Component,\n    properties: {},\n    onLoad() {\n        this.node.index = this;\n        if (cc.sys.isBrowser) {\n            this._updateLanguageConfig();\n        }\n    },\n    start() {\n        if (!this || !this.node || !this.node.director) return;\n        this.gameId = this.node.config.GAME_ID;\n        this.node.gSlotDataStore.gameId = this.gameId;\n        this.node.director.init();\n        this.connect();\n        this._isOnStarted = false;\n    },\n\n    update(){\n        if(!this._isOnStarted){\n            this._isOnStarted = true;\n            this.node.director.initGameMode();\n        }\n    },\n    connect() {\n        const autoConnect = new connect();\n        autoConnect.loginScene({\n            callback: this.init.bind(this),\n            gameId: this.gameId,\n            gameNode: this.node,\n            callbackAuthFailed: this.authFailed.bind(this)\n        });\n    },\n    init() {\n        if (!this || !this.node || !this.node.director) return;\n        this.node.director.setUpGame();\n            \n    },\n    authFailed() {\n        if (!this || !this.node || !this.node.director) return;\n        this.node.director.showMessageAuthFailed();\n    },\n    _updateLanguageConfig() {\n        this.languageCode = this._getLanguage();\n        window.languageCode = this.languageCode;\n    },\n    _getLanguage() {\n        const { getUrlParam } = require(\"gameCommonUtils\");\n        const loadConfigAsync = require('loadConfigAsync');\n        const { LOGIN_IFRAME } = loadConfigAsync.getConfig();\n        const defaultLanguage = window.defaultLanguage || 'VI';\n        let language = '';\n        if (LOGIN_IFRAME) {\n            language = getUrlParam('l') || defaultLanguage;\n            if (!CC_PREVIEW) {\n                const folderLanguage = settings ? settings.folderLanguage : undefined;\n                if (folderLanguage && folderLanguage !== 'all') { //priority get folder language on preprod\n                    language = folderLanguage;\n                }\n            }\n        } else {\n            language = cc.sys.localStorage.getItem('l') || defaultLanguage;\n        }\n        return language.toUpperCase();\n    },\n    onDestroy() {\n        if (cc.sys.isNative && typeof(closeCreatorGame) !== 'function') {\n            cc.audioEngine.stopAll();\n        }\n        if (this.node.director && this.node.director.gameStateManager) {\n            this.node.director.gameStateManager.outGame();\n        }\n    },\n});\n"]}