{"version":3,"sources":["JackpotHistory.js"],"names":["cc","Class","extends","require","properties","noJackpotText","Node","isMiniGame","initialized","jpList","pageIndex","onLoad","initBase","start","localizeText","node","config","MESSAGE_DIALOG","NO_JACKPOT_HISTORY","getComponentInChildren","Label","string","ERROR_CONNECTION_HISTORY","errorMessage","label","getComponent","HISTORY_PAGE","openPanel","table","emit","serverMessage","active","_super","url","loadConfigAsync","getConfig","LOGIN_IFRAME","betIds","BET_IDS","BET_IDS_IFRAME","JP_LIST_HISTORY","init","GAME_ID","gameId","soundPlayer","jpPrefix","playSoundClick","playClickButton","bind","initObj","clickFromMain","sys","os","OS_IOS","isBrowser","playLoading","onRequestResponse","res","error","msg","Object","keys","length","data"],"mappings":"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","file":"JackpotHistory.js","sourceRoot":"../../../../../../../assets/cc-common/cc-share-v1/History/Scripts","sourcesContent":["cc.Class({\n    extends: require(\"BaseHistory\"),\n\n    properties: {\n        noJackpotText: cc.Node,\n        isMiniGame: false,\n        initialized: false,\n        jpList: \"GRAND-MAJOR\",\n        pageIndex: cc.Node,\n    },\n\n    onLoad()\n    {\n        this.initBase();\n    },\n    start(){\n        this.localizeText();\n    },\n    localizeText() {\n        if (this.node.config.MESSAGE_DIALOG) {\n            if (this.node.config.MESSAGE_DIALOG.NO_JACKPOT_HISTORY) {\n                this.noJackpotText.getComponentInChildren(cc.Label).string = this.node.config.MESSAGE_DIALOG.NO_JACKPOT_HISTORY;\n            }\n            if (this.node.config.MESSAGE_DIALOG.ERROR_CONNECTION_HISTORY && this.errorMessage) {\n                let label = this.errorMessage.getComponentInChildren(cc.Label) || this.errorMessage.getComponent(cc.Label);\n                if (label) {\n                    label.string = this.node.config.MESSAGE_DIALOG.ERROR_CONNECTION_HISTORY;\n                }\n            }\n            if (this.pageIndex && this.node.config.MESSAGE_DIALOG.HISTORY_PAGE) {\n                this.pageIndex.getComponentInChildren(cc.Label).string = this.node.config.MESSAGE_DIALOG.HISTORY_PAGE;\n            }\n        }\n    },\n    openPanel() {\n        this.table.emit('CLEAR_DATA');\n        if (this.serverMessage) this.serverMessage.active = false;\n        this._super();\n        if(this.pageIndex) this.pageIndex.active = false;\n    },\n    initBase()\n    {\n        if(this.initialized)\n            return;\n        this._super();\n        this.url = \"jackpothistory/slot\";\n        this.noJackpotText.active = false;\n        const loadConfigAsync = require('loadConfigAsync');\n        const {LOGIN_IFRAME} = loadConfigAsync.getConfig();\n\n        if (this.node.config)\n        {\n            let betIds = this.node.config.BET_IDS;\n            if (LOGIN_IFRAME)\n            {\n                betIds = this.node.config.BET_IDS_IFRAME;\n            }\n            if (this.node.config.JP_LIST_HISTORY)\n                this.jpList = this.node.config.JP_LIST_HISTORY;\n            this.init(this.node.config.GAME_ID, null, betIds, this.jpList);\n        }\n        //\n        this.initialized = true;\n    },\n\n    //slot v1\n    init(gameId, soundPlayer, betIds, jpList = \"GRAND-MAJOR\", jpPrefix = \"kts_\", url = \"jackpothistory/slot\")\n    {\n        this.gameId = gameId;\n        this.jpList = jpList;\n        this.betIds = betIds;\n        this.jpPrefix = jpPrefix;\n        if (this.isMiniGame) {\n            this.jpPrefix = 'ktmn_';\n        }\n        this.url = url;\n\n        if (!this.node.soundPlayer && soundPlayer != null)\n            this.node.soundPlayer = soundPlayer;\n\n        if (soundPlayer)\n            this.playSoundClick = soundPlayer.playClickButton.bind(soundPlayer);\n    },\n\n    // fish-client\n    initObj () { \n        //this.node.emit(DTConstantsVariable.PANEL_EVENT.Show);\n        this.openPanel();\n    },\n\n    clickFromMain() {\n        if (cc.sys.os != cc.sys.OS_IOS || !cc.sys.isBrowser) {\n            this.node.emit(\"SHOW_PANEL\");\n            this.openPanel();\n        }\n    },\n    \n    playLoading(){\n        this._super();\n        this.serverMessage.active = false;\n        this.noJackpotText.active = false;\n    },\n\n    onRequestResponse(res)\n    {\n        this._super(res);\n        if (res.error && res.error.msg) {\n            this.table.emit('CLEAR_DATA');\n            this.serverMessage.active = true;\n            this.serverMessage.getComponentInChildren(cc.Label).string = res.error.msg;\n            if(this.pageIndex) this.pageIndex.active = false;\n        }\n        else if (res.error || Object.keys(res).length <= 0 || !res.data || res.data.length <= 0)\n        {\n            this.noJackpotText.active = true; \n            if (this.pageIndex)this.pageIndex.active = false;\n        }\n        else\n        {\n            this.noJackpotText.active = false;\n            if (this.pageIndex)this.pageIndex.active = true;\n        }\n    }\n});\n"]}