{"version":3,"sources":["../../../../../../../../assets/cc-common/cc-slotbase-v2/g9000/cutscene/winEffect/assets/cc-common/cc-slotbase-v2/g9000/cutscene/winEffect/WinEffectv2.js"],"names":["require","reverseEasing","formatMoney","cc","Class","extends","properties","megaRate","superRate","winAmount","Node","overlayNode","fastParticle","ParticleSystem","title","titleFrame","SpriteFrame","winInfo","coinsEffect","delayShowTime","hideTime","animDuration","onLoad","_super","label","getComponentInChildren","Label","isShowFastEffect","isShowNormalEffect","enter","node","stopAllActions","modeTurbo","gSlotDataStore","showFastEffectWin","showEffectWin","fullDisplay","callback","opacity","active","runAction","sequence","delayTime","fadeIn","resetSystem","_fastEffectAction","stopAction","callFunc","stopSystem","exit","playSoundStart","scaleTime","repeatForever","scaleTo","initValue","startParticle","startUpdateWinAmount","playSoundEnd","scale","currentValue","currentTitle","string","getComponent","Sprite","spriteFrame","megaWinAmount","content","currentBetData","superWinAmount","isUpdating","speedUp","bindQuickShow","skippable","emit","speedUpEasing","t","slowDownEasing","halfAmount","currentTween","tween","to","easing","delay","call","finish","start","update","changeTitle","index","onClick","stop","stopParticle","mainDirector","onIngameEvent","onDisable"],"mappings":"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","file":"WinEffectv2.js","sourceRoot":"../../../../../../../../assets/cc-common/cc-slotbase-v2/g9000/cutscene/winEffect","sourcesContent":["const {reverseEasing} = require('globalAnimationLibrary');\nconst {formatMoney} = require('utils');\n\ncc.Class({\n    extends: require('CutsceneMode'),\n\n    properties: {\n        megaRate: 25,\n        superRate: 40,\n        winAmount: cc.Node,\n        overlayNode: cc.Node,\n        fastParticle: cc.ParticleSystem,\n        title: cc.Node,\n        titleFrame: [cc.SpriteFrame],\n        winInfo: cc.Node,\n        coinsEffect: cc.Node,\n        delayShowTime: 2,\n        hideTime: 0.5,\n        animDuration: 9\n    },\n\n    onLoad() {\n        this._super();\n        this.label = this.winAmount.getComponentInChildren(cc.Label);\n        this.isShowFastEffect = false;\n        this.isShowNormalEffect = false;\n    },\n\n    enter() {\n        this.node.stopAllActions();\n        let modeTurbo = false;\n        if (this.node.gSlotDataStore) modeTurbo = this.node.gSlotDataStore.modeTurbo;   \n        modeTurbo ? this.showFastEffectWin() : this.showEffectWin();\n        this.node.fullDisplay = !modeTurbo;\n    },\n\n    showFastEffectWin() {  // turbo\n        if (this.isShowFastEffect) {\n            this.callback && this.callback();\n            this.callback = null;\n            return;\n        }\n        this.isShowFastEffect = true;\n        this.winInfo.opacity = 0;\n        if (this.overlayNode) {\n            this.overlayNode.active = false;\n        }\n        this.fastParticle.node.opacity = 0;\n        this.fastParticle.node.stopAllActions();\n        this.fastParticle.node.runAction(cc.sequence(\n            cc.delayTime(0.1),\n            cc.fadeIn(0.1),\n        ));\n        this.fastParticle.resetSystem();\n        this.callback && this.callback();\n        this.callback = null;\n        if( this._fastEffectAction){\n            this.node.stopAction(this._fastEffectAction);\n        }\n        this._fastEffectAction = cc.sequence(\n            cc.delayTime(1),\n            cc.callFunc(()=>{\n                this.fastParticle.stopSystem();\n            }),\n            cc.delayTime(2),\n            cc.callFunc(()=>{\n                this.exit();\n            }),\n        );\n        this.node.runAction(this._fastEffectAction);\n    },\n\n    showEffectWin() {\n        this.isShowNormalEffect = true;\n        if(this.overlayNode){\n            this.overlayNode.active = true;\n        }\n        this.winInfo.opacity = 255;\n        this.playSoundStart();\n        const scaleTime = 0.2;\n        this.winAmount.stopAllActions();\n        this.winAmount.runAction(cc.repeatForever(cc.sequence(\n            cc.scaleTo(scaleTime, 1.2),\n            cc.scaleTo(scaleTime, 1),\n        )));\n        if (this.title) {\n            this.title.stopAllActions();\n            this.title.runAction(cc.repeatForever(cc.sequence(\n                cc.scaleTo(0.5, 1.2),\n                cc.scaleTo(0.5, 1),\n            )));\n        }\n        this.initValue();\n        this.startParticle();\n        this.startUpdateWinAmount();\n    },\n\n    playSoundStart() {\n\n    },\n\n    playSoundEnd() {\n\n    },\n\n    initValue() {\n        this.winInfo.scale = 1;\n        this.currentValue = 0;\n        this.currentTitle = 0;\n        this.label.string = '';\n        if (this.title) {\n            this.title.getComponent(cc.Sprite).spriteFrame = this.titleFrame[0];\n        }\n        this.megaWinAmount = this.content.currentBetData * this.megaRate;\n        this.superWinAmount = this.content.currentBetData * this.superRate;\n        this.isUpdating = true;\n        this.speedUp = false;\n        this.bindQuickShow();\n    },\n\n    bindQuickShow() {\n        this.skippable = false;\n        this.node.stopAllActions();\n        this.node.runAction(cc.sequence(\n            cc.delayTime(this.hideTime),\n            cc.callFunc(() => {\n                this.skippable = true;\n            }),\n            cc.delayTime(this.animDuration - this.delayShowTime),\n            cc.callFunc(() => {\n                this.skippable = false;\n            }),\n        ));\n    },\n\n    startParticle() {\n        this.coinsEffect.emit('START_PARTICLE');\n        if(this.content.winAmount > this.megaWinAmount) {\n            this.coinsEffect.emit('DROP_MONEY');\n        }\n    },\n\n    startUpdateWinAmount() {\n        const speedUpEasing = t => t*t; // constant accelerated\n        const slowDownEasing = reverseEasing(t => t*t);\n        const halfAmount = 0.5 * this.content.winAmount;\n        this.currentTween = cc.tween(this);\n        this.currentTween\n            .to(0.5*this.animDuration, {currentValue: halfAmount}, {easing: speedUpEasing})\n            .to(0.5*this.animDuration, {currentValue: this.content.winAmount}, {easing: slowDownEasing})\n            .delay(0.5)\n            .call(() => {\n                this.skippable = false;\n                this.currentTween = null;\n                this.finish();\n            });\n        this.currentTween.start();\n    },\n\n    update() {\n        if (!this.isUpdating) return;\n        this.label.string = formatMoney(this.currentValue);\n        if (this.currentValue >= this.superWinAmount && this.currentTitle == 1) {\n            this.changeTitle(2);\n        } else if (this.currentValue >= this.megaWinAmount  && this.currentTitle == 0) {\n            this.changeTitle(1);\n        }\n    },\n\n    changeTitle(index) {\n        this.currentTitle = index;\n        if (!this.title) return;\n        this.title.stopAllActions();\n        cc.tween(this.title)\n            .to(0.3, {scale: 2, opacity: 0})\n            .call(()=>{\n                this.title.getComponent(cc.Sprite).spriteFrame = this.titleFrame[index];\n            })\n            .to(0.3, {scale: 1, opacity: 255})\n            .call(()=>{\n                this.title.stopAllActions();\n                this.title.runAction(cc.repeatForever(cc.sequence(\n                    cc.scaleTo(0.5, 1.2),\n                    cc.scaleTo(0.5, 1),\n                )));\n            })\n            .start();\n    },\n\n    onClick() {\n        if (!this.isUpdating || this.speedUp) return;\n        if (!this.skippable) return;\n\n        this.speedUp = true;\n        this.winAmount.stopAllActions();\n        const scaleTime = 0.13;\n        this.winAmount.stopAllActions();\n        this.winAmount.runAction(cc.repeatForever(cc.sequence(\n            cc.scaleTo(scaleTime, 1.2),\n            cc.scaleTo(scaleTime, 1),\n        )));\n\n        this.playSoundEnd();\n\n        if (this.currentTween) {\n            this.currentTween.stop();\n            this.currentTween = null;\n        }\n        cc.tween(this)\n            .to(1, {currentValue: this.content.winAmount})\n            .call(() => {\n                this.finish();\n            })\n            .start();\n    },\n\n    stopParticle() {\n        this.coinsEffect.emit('STOP_PARTICLE');\n    },\n\n    finish() {\n        this.isUpdating = false;\n        this.label.string = formatMoney(this.content.winAmount);\n        this.winAmount.stopAllActions();\n        this.stopParticle();\n        this.winInfo.stopAllActions();\n        this.winInfo.runAction(cc.sequence(\n            cc.delayTime(this.delayShowTime),\n            cc.scaleTo(this.hideTime, 0),\n            cc.callFunc(()=>{\n                //this.node.soundPlayer.playBackgroundMusic();\n                this.label.string = '';\n                this.winInfo.opacity = 0;\n                this.exit(); // exit cutscene\n            })\n        ));\n    },\n    exit(){\n        this.isShowFastEffect = false;\n        this.isShowNormalEffect = false;\n        this.callback && this.callback();\n        this.callback = null;\n        this.node.emit(\"STOP\");\n        if(this.node.mainDirector && this.node.mainDirector.onIngameEvent){\n            this.node.mainDirector.onIngameEvent(\"ON_CUTSCENE_CLOSE\");\n        }\n        this.node.active = false;\n    },\n\n    onDisable() {\n        if (this.currentTween) {\n            this.currentTween.stop();\n            this.currentTween = null;\n        }\n    }\n});\n"]}