{"version":3,"sources":["../../../../../../../assets/cc-common/cc-share-v1/shader/shaderEffect/assets/cc-common/cc-share-v1/shader/shaderEffect/vintageFadeOut.js"],"names":["START_R_M","MAX_BLUR_STR","cc","Class","extends","Component","properties","transitionDur","blurDur","onLoad","node","activeTransition","bind","start","sprite","getComponent","Sprite","material","getMaterial","timePassed","setProperty","startBlur","runAction","sequence","delayTime","callFunc","startFadeOut","update","blurActived","blurStr","transitionActived","radiusMultiple","Math","max","tween","to","easing","call","scaleTo"],"mappings":";;;;;;AAAA,IAAMA,YAAY,EAAlB;AACA,IAAMC,eAAe,CAArB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,uBAAe,GADP;AAERC,iBAAS;AAFD,KAHP;;AAQLC,UARK,oBAQG;AACJ,aAAKC,IAAL,CAAUC,gBAAV,GAA6B,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAA7B;AACH,KAVI;AAYLC,SAZK,mBAYI;AACL,YAAMC,SAAS,KAAKJ,IAAL,CAAUK,YAAV,CAAuBb,GAAGc,MAA1B,CAAf;AACA,YAAGF,MAAH,EAAW;AACP,iBAAKG,QAAL,GAAgBH,OAAOI,WAAP,CAAmB,CAAnB,CAAhB;AACH;AACD,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKF,QAAL,CAAcG,WAAd,CAA0B,UAA1B,EAAsC,CAAtC;AACA,aAAKH,QAAL,CAAcG,WAAd,CAA0B,gBAA1B,EAA4C,CAA5C;AACH,KApBI;AAsBLT,oBAtBK,8BAsBa;AAAA;;AACd,aAAKM,QAAL,CAAcG,WAAd,CAA0B,UAA1B,EAAsC,CAAtC;AACA,aAAKH,QAAL,CAAcG,WAAd,CAA0B,gBAA1B,EAA4C,CAA5C;AACA,aAAKC,SAAL;AACA,aAAKX,IAAL,CAAUY,SAAV,CAAoBpB,GAAGqB,QAAH,CAChBrB,GAAGsB,SAAH,CAAa,KAAKhB,OAAlB,CADgB,EAEhBN,GAAGuB,QAAH,CAAY,YAAI;AACZ,kBAAKC,YAAL;AACH,SAFD,CAFgB,CAApB;AAMA,eAAO,KAAKnB,aAAL,GAAqB,KAAKC,OAAjC;AACH,KAjCI;AAmCLmB,UAnCK,oBAmCK;AACN,YAAG,CAAC,KAAKV,QAAT,EAAmB;AACnB,YAAG,KAAKW,WAAR,EAAqB;AACjB,iBAAKX,QAAL,CAAcG,WAAd,CAA0B,UAA1B,EAAsC,KAAKS,OAA3C;AACH;AACD,YAAG,KAAKC,iBAAR,EAA2B;AACvB,gBAAMC,iBAAiBC,KAAKC,GAAL,CAAS,GAAT,EAAcjC,YAAY,KAAKmB,UAA/B,CAAvB;AACA,iBAAKF,QAAL,CAAcG,WAAd,CAA0B,gBAA1B,EAA4CW,cAA5C;AACH;AACJ,KA5CI;AA8CLL,gBA9CK,0BA8CS;AAAA;;AACV,aAAKI,iBAAL,GAAyB,IAAzB;AACA,aAAKX,UAAL,GAAkB,CAAlB;AACAjB,WAAGgC,KAAH,CAAS,IAAT,EACKC,EADL,CACQ,KAAK5B,aADb,EAC4B,EAACY,YAAYnB,SAAb,EAD5B,EACqD,EAACoC,QAAQ,UAAT,EADrD,EAEKC,IAFL,CAEU,YAAI;AACN,mBAAKP,iBAAL,GAAyB,KAAzB;AACH,SAJL,EAKKjB,KALL;AAMH,KAvDI;AAyDLQ,aAzDK,uBAyDM;AACP,aAAKQ,OAAL,GAAe,CAAf;AACA,aAAKD,WAAL,GAAmB,IAAnB;AACA1B,WAAGgC,KAAH,CAAS,IAAT,EACKC,EADL,CACQ,KAAK5B,aADb,EAC4B,EAACsB,SAAS5B,YAAV,EAD5B,EAEKY,KAFL;AAGA,aAAKH,IAAL,CAAUY,SAAV,CAAoBpB,GAAGoC,OAAH,CAAW,KAAK/B,aAAhB,EAA+B,CAA/B,CAApB;AACH;AAhEI,CAAT","file":"vintageFadeOut.js","sourceRoot":"../../../../../../../assets/cc-common/cc-share-v1/shader/shaderEffect","sourcesContent":["const START_R_M = 30;\nconst MAX_BLUR_STR = 1;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        transitionDur: 1.0,\n        blurDur: 0.2,\n    },\n\n    onLoad(){\n        this.node.activeTransition = this.activeTransition.bind(this);\n    },\n\n    start () {\n        const sprite = this.node.getComponent(cc.Sprite);\n        if(sprite) {\n            this.material = sprite.getMaterial(0);\n        }\n        this.timePassed = 0;\n        this.material.setProperty('Strength', 0);\n        this.material.setProperty('radiusMultiple', 0);\n    },\n\n    activeTransition(){\n        this.material.setProperty('Strength', 0);\n        this.material.setProperty('radiusMultiple', 0);\n        this.startBlur();\n        this.node.runAction(cc.sequence(\n            cc.delayTime(this.blurDur),\n            cc.callFunc(()=>{\n                this.startFadeOut();\n            })\n        ));\n        return this.transitionDur + this.blurDur;\n    },\n\n    update () {\n        if(!this.material) return;\n        if(this.blurActived) {\n            this.material.setProperty('Strength', this.blurStr);\n        }\n        if(this.transitionActived) {\n            const radiusMultiple = Math.max(0.0, START_R_M - this.timePassed);\n            this.material.setProperty('radiusMultiple', radiusMultiple);\n        }\n    },\n\n    startFadeOut(){\n        this.transitionActived = true;\n        this.timePassed = 0;\n        cc.tween(this)\n            .to(this.transitionDur, {timePassed: START_R_M}, {easing: 'cubicOut'})\n            .call(()=>{\n                this.transitionActived = false;\n            })\n            .start();\n    },\n\n    startBlur(){\n        this.blurStr = 0;\n        this.blurActived = true;\n        cc.tween(this)\n            .to(this.transitionDur, {blurStr: MAX_BLUR_STR})\n            .start();\n        this.node.runAction(cc.scaleTo(this.transitionDur, 3));\n    }\n});\n"]}